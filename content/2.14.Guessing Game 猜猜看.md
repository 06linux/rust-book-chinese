# 猜猜看
好的！我们搞定了Rust的基础。让我们写点逼格er的程序。

作为我们的第一个项目，我们来实现一个经典新手编程问题：猜猜看游戏。它是这么工作的：我们的程序将会随机生成一个1到100之间的随机数。当我们猜了一个数之后，它会告诉我们是大了还是小了。当我们猜对了，它会祝贺我们。听起来如何？

## 准备
我们准备一个新项目。进入到你的项目目录。还记得我们曾经创建我们`hello_world`的项目目录和`Cargo.toml`文件吗？Cargo有一个命令来为我们做这些。让我们试试：
```bash
$ cd ~/projects
$ cargo new guessing_game --bin
$ cd guessing_game
```
我们将项目名字传递给`cargo new`，然后用了`--bin`标记，因为我们要创建一个二进制文件，而不是一个库文件。

查看生成的`Cargo.toml`文件：
```toml
[package]

name = "guessing_game"
version = "0.0.1"
authors = ["Your Name <you@example.com>"]
```
Cargo从环境变量中获取这些信息。如果这不对，赶紧修改它。

最后，Cargo为我们生成了应给“Hello, world!”。查看`src/main.rs`文件：
```rust
fn main() {
    println!("Hello, world!")
}
```
让我们编译Cargo为我们生成的项目：
```bash
$ cargo build
   Compiling guessing_game v0.0.1 (file:///home/you/projects/guessing_game)
```
很好，再次打开你的`src/main.rs`文件。我们会将所有代码写在这个文件里。稍后我们会讲到多文件项目。

在我们继续之前，让我们再告诉你一个新的Cargo命令：`run`。`cargo run`跟`cargo build`类似，并且还会运行我们刚生成的可执行文件。试试它：
```bash
$ cargo run
   Compiling guessing_game v0.0.1 (file:///home/you/projects/guessing_game)
     Running `target/guessing_game`
Hello, world!
```
很好！`run`命令在我们需要快速重复运行一个项目是非常方便。我们的游戏就是这么一个项目，在我们添加新内容之前我们需要经常快速测试项目。

## 处理一次猜测
下面，我们要生成一个隐藏的数字。为了实现这个目的，我们要使用我们还未讲到的Rsut随机数生成器。Rust的标准库中有一大堆有意思的函数。如果你需要一些代码，可能它们已经被写好了！在这里，我们确实知道Rust有随机数生成器，只不过我们不知道怎么用。

查看文档。Rust有一个页面专门介绍标准库。你可以在这里查看这个[页面](http://doc.rust-lang.org/std/)。这里有很多信息，不过最亮的部分是搜索栏。在页面的最上面，这有一个文本框你可以输入搜索内容。搜索现在还很原始，不过正在一直变得更好。如果你输入“random”，它将会出现[这个页面](http://doc.rust-lang.org/std/?search=random)。第一个结果是一个链接[std::rand::random](http://doc.rust-lang.org/std/rand/fn.random.html)。如果我们点击它，我们会看到关于它的文档。

这个页面告诉了我们一些信息：函数的生命，一些解释性文字然后是一个用例。让我们修改我们的代码来加入`random`函数并看看会发生什么：
```rsut
use std::old_io;
use std::rand;

fn main() {
    println!("Guess the number!");

    let secret_number = (rand::random() % 100) + 1; // secret_number: i32

    println!("The secret number is: {}", secret_number);

    println!("Please input your guess.");

    let input = old_io::stdin().read_line()
                           .ok()
                           .expect("Failed to read line");


    println!("You guessed: {}", input);
}
```
我们修改的第一点是`use std::rand`，就像文档里说的。我们接着添加了一个`let`表达式来创建一个叫`secret_number`的变量绑定，然后我们把它打印出来。

另外，你可以会好奇我们对`rand::random()`的结果使用了`%`运算符。这个运算符叫做*取模*，它返回除法的余数。通过对`rand::random()`的结果取余数，我们可以限制结果在0到99之间。接着我们对结果加一，使其变成1到100之间。通过取模操作，我们可以生成一个乖离率非常非常小的结果，不过对于我们的例子来说这并不重要。

让我们用`cargo build`来编译项目：
```bash
$ cargo build
   Compiling guessing_game v0.0.1 (file:///home/you/projects/guessing_game)
src/main.rs:7:26: 7:34 error: the type of this value must be known in this context
src/main.rs:7     let secret_number = (rand::random() % 100) + 1;
                                       ^~~~~~~~
error: aborting due to previous error
```
它不能工作！Rust说“在此上下文中我们必须知道这个值得类型”。这发生了什么？好吧，事实证明`rand::random()`可以生成很多类型的值，不仅仅是整形。在这个例子中，Rust不知道`random()`应该生成什么类型的随机数。所以我们必须帮助它。对于整数值，我们可以在后面加上一个`i32`来告诉Rust它们是整形的，不过这个对函数不起作用。它有一个不同的语法，它看起来像：
```rsut
rand::random::<i32>();
```
它说“请给我一个`i32`的随机数”。我们修改代码来加上这个提示：
```rust
use std::old_io;
use std::rand;

fn main() {
    println!("Guess the number!");

    let secret_number = (rand::random::<i32>() % 100) + 1;

    println!("The secret number is: {}", secret_number);

    println!("Please input your guess.");

    let input = old_io::stdin().read_line()
                           .ok()
                           .expect("Failed to read line");


    println!("You guessed: {}", input);
}
```
试试运行我们的新程序几次：
```bash
$ cargo run
   Compiling guessing_game v0.0.1 (file:///home/you/projects/guessing_game)
     Running `target/guessing_game`
Guess the number!
The secret number is: 7
Please input your guess.
4
You guessed: 4
$ ./target/guessing_game
Guess the number!
The secret number is: 83
Please input your guess.
5
You guessed: 5
$ ./target/guessing_game
Guess the number!
The secret number is: -29
Please input your guess.
42
You guessed: 42
```
等等，-29？我们需要一个1到100之间的数字！这里我们有两个选项：我们要么要求`random()`生成一个无符号数，它只能是正值；要么我们可以使用`abs()`函数。
